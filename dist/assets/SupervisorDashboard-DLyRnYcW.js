import{u as Ze,j as e}from"./index-B34CxXhK.js";import{f as Pe,r as n,L as Be}from"./react-BeLGUnOF.js";import{C as Ve}from"./ChartComponent-B221MXQ3.js";import{L as Ye}from"./LoadingSpinner-DT6bjMH5.js";const b="http://localhost:4000",x={Zone:()=>e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.447-.894L15 4m0 13V4m0 0L9 7"})}),Chief:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),Clients:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),Arrow:()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),TrendUp:()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})},Oe=()=>{const{t:a,lang:T}=Ze(),oe=Pe(),[h,le]=n.useState([]),[p,Z]=n.useState(!1),[P,B]=n.useState(null),[ie,de]=n.useState([]),[ce,V]=n.useState(!1),[Y,W]=n.useState(null),[R,S]=n.useState([]),[me,xe]=n.useState(0),[q,C]=n.useState({yearly:[],monthly:[],weekly:[],daily:[]}),he=new Date,[M,ue]=n.useState(he.getFullYear()),[w,ge]=n.useState(0),[N,fe]=n.useState(""),[_,be]=n.useState(!1),L=n.useRef(null),[A,pe]=n.useState([]),[ve,K]=n.useState(!1),[O,U]=n.useState(null),[je,$]=n.useState(!1),[we,Ne]=n.useState(""),[D,H]=n.useState(!1),[v,J]=n.useState(null),[u,ye]=n.useState(null),[ke,Se]=n.useState(0),[Ce,G]=n.useState(!1),[Q,X]=n.useState(null),[ee,se]=n.useState([]),[F,te]=n.useState(null);n.useEffect(()=>{const s=localStorage.getItem("token");if(!s){oe("/login",{replace:!0});return}Z(!0),B(null),fetch(`${b}/api/supervisor/zones`,{headers:{Authorization:`Bearer ${s}`}}).then(async r=>{const t=await r.json();if(!r.ok)throw new Error((t==null?void 0:t.error)||"Failed to load zones");le(Array.isArray(t.zones)?t.zones:[])}).catch(r=>B((r==null?void 0:r.message)||"Failed to load zones")).finally(()=>Z(!1))},[]),n.useEffect(()=>{const s=localStorage.getItem("token");s&&(H(!0),J(null),fetch(`${b}/api/supervisor/payment-totals`,{headers:{Authorization:`Bearer ${s}`}}).then(async r=>{const t=await r.json();if(!r.ok)throw new Error((t==null?void 0:t.error)||"Failed to load totals");ye({due_total:Number((t==null?void 0:t.due_total)||0),paid_total:Number((t==null?void 0:t.paid_total)||0),remaining_total:Number((t==null?void 0:t.remaining_total)||0),year:t==null?void 0:t.year,month:t==null?void 0:t.month})}).catch(r=>J((r==null?void 0:r.message)||"Failed to load totals")).finally(()=>H(!1)))},[]),n.useEffect(()=>{const s=localStorage.getItem("token");s&&(K(!0),U(null),fetch(`${b}/api/supervisor/vehicles`,{headers:{Authorization:`Bearer ${s}`}}).then(async r=>{const t=await r.json();if(!r.ok)throw new Error((t==null?void 0:t.error)||"Failed to load vehicles");pe(Array.isArray(t.vehicles)?t.vehicles:[])}).catch(r=>U((r==null?void 0:r.message)||"Failed to load vehicles")).finally(()=>K(!1)))},[]);const Me=s=>{if(!s)return!1;const r=new Date(s),t=new Date;return r.getFullYear()===t.getFullYear()&&r.getMonth()===t.getMonth()&&r.getDate()===t.getDate()};n.useEffect(()=>{const s=localStorage.getItem("token");if(!s||!h.length)return;const r=new Set(h.map(t=>t.id));G(!0),X(null),fetch(`${b}/api/payments/statements`,{headers:{Authorization:`Bearer ${s}`}}).then(async t=>{const i=await t.json();if(!t.ok)throw new Error((i==null?void 0:i.error)||"Failed to load payments");const m=(Array.isArray(i==null?void 0:i.payments)?i.payments:[]).filter(l=>!(l!=null&&l.status)||String(l.status).toLowerCase().startsWith("success")).filter(l=>r.has(Number(l==null?void 0:l.zone_id))).filter(l=>Me((l==null?void 0:l.completed_at)||(l==null?void 0:l.created_at)||(l==null?void 0:l.updated_at)||(l==null?void 0:l.inserted_at))).reduce((l,j)=>l+Number(j.amount||0),0);Se(m)}).catch(t=>X((t==null?void 0:t.message)||a("supervisor.error.generic"))).finally(()=>G(!1))},[h]);const g=n.useMemo(()=>new Intl.NumberFormat(void 0,{maximumFractionDigits:0}),[T]);function _e(s=6){const r=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],t=new Date,i=[];for(let d=s-1;d>=0;d--){const m=new Date(t.getFullYear(),t.getMonth()-d,1),l=`${m.getFullYear()}-${String(m.getMonth()+1).padStart(2,"0")}`;i.push({key:l,label:r[m.getMonth()]})}return i}function Le(s){const r=_e(6),t=new Map(r.map(o=>[o.key,0])),i=new Date,d=`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}`,m=[0,0,0,0],l=Array.from({length:5},(o,c)=>String(new Date().getFullYear()-(4-c))),j=new Map(l.map(o=>[o,0])),ne=[],z=[];for(let o=6;o>=0;o--){const c=new Date(i);c.setDate(i.getDate()-o);const f=`${c.getFullYear()}-${String(c.getMonth()+1).padStart(2,"0")}-${String(c.getDate()).padStart(2,"0")}`;z.push(f),ne.push(`Day ${7-o}`)}const y=new Map(z.map(o=>[o,0])),De=Array.isArray(s)?s.filter(o=>{const c=String((o==null?void 0:o.status)||"").toLowerCase();return!(o!=null&&o.status)||c==="success"||c==="successful"}):[];for(const o of De){const c=Number(o.amount||0),f=new Date(o.completed_at||o.created_at||o.updated_at||o.inserted_at||Date.now()),k=`${f.getFullYear()}-${String(f.getMonth()+1).padStart(2,"0")}`;if(t.has(k)&&t.set(k,(t.get(k)||0)+c),k===d){const Te=Math.min(4,Math.max(1,Math.ceil(f.getDate()/7)));m[Te-1]+=c}const E=String(f.getFullYear());j.has(E)&&j.set(E,(j.get(E)||0)+c);const I=`${f.getFullYear()}-${String(f.getMonth()+1).padStart(2,"0")}-${String(f.getDate()).padStart(2,"0")}`;y.has(I)&&y.set(I,(y.get(I)||0)+c)}const Fe=l.map(o=>({year:o,amount:j.get(o)||0})),ze=r.map(o=>({month:o.label,amount:t.get(o.key)||0})),Ee=[{week:"Week 1",amount:m[0]},{week:"Week 2",amount:m[1]},{week:"Week 3",amount:m[2]},{week:"Week 4",amount:m[3]}],Ie=z.map((o,c)=>({day:ne[c],amount:y.get(o)||0}));return{yearly:Fe,monthly:ze,weekly:Ee,daily:Ie}}n.useEffect(()=>{let s=!1;async function r(){try{V(!0);const t=localStorage.getItem("token");if(!t){s||(C({yearly:[],monthly:[],weekly:[],daily:[]}),S([]));return}W(null);const d=await(await fetch(`${b}/api/payments/completed`,{headers:{Authorization:`Bearer ${t}`}})).json(),m=Array.isArray(d==null?void 0:d.payments)?d.payments:[];s||S(m)}catch(t){s||(W((t==null?void 0:t.message)||a("supervisor.error.generic")),S([]),C({yearly:[],monthly:[],weekly:[],daily:[]}))}finally{s||V(!1)}}return r(),()=>{s=!0}},[me]);const re=n.useMemo(()=>{const s=r=>{if(!r)return!1;const t=new Date(r),i=t.getMonth()+1;return!(t.getFullYear()!==M||w&&i!==w)};return R.filter(r=>!(N&&String((r==null?void 0:r.zone_id)??"")!==String(N)||!s((r==null?void 0:r.completed_at)||(r==null?void 0:r.created_at)||(r==null?void 0:r.updated_at)||(r==null?void 0:r.inserted_at))))},[R,N,M,w]);n.useEffect(()=>{const s=Le(re);C(s)},[re]),n.useEffect(()=>{de(q.monthly||[])},[q]);const ae=h.reduce((s,r)=>s+r.client_count,0),Ae=h.filter(s=>s.chief_username).length,$e=h.length>0?Math.round(ae/h.length):0;return e.jsxs("div",{className:"space-y-8 overflow-x-hidden",children:[ee.length>0&&e.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-amber-100 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h2",{className:"text-lg font-semibold text-stone-800",children:"Password Reset Requests"}),e.jsx("button",{className:"text-sm text-amber-700 underline",onClick:async()=>{const s=localStorage.getItem("token");if(s)try{const r=await fetch(`${b}/api/password/supervisor/requests`,{headers:{Authorization:`Bearer ${s}`}}),t=await r.json();if(!r.ok)throw new Error((t==null?void 0:t.error)||"Failed");se(Array.isArray(t==null?void 0:t.requests)?t.requests:[])}catch{}},children:a("common.refresh")})]}),e.jsx("div",{className:"space-y-2",children:ee.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border border-amber-100 bg-amber-50/40",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-medium text-stone-900",children:[s.username," ",e.jsxs("span",{className:"text-xs text-stone-500",children:["(",s.role,")"]})]}),s.emailHint&&e.jsxs("div",{className:"text-xs text-stone-600",children:["Email: ",s.emailHint]}),e.jsxs("div",{className:"text-xs text-stone-500",children:["Requested at: ",new Date(s.createdAt).toLocaleString()]})]}),e.jsx("button",{disabled:F===s.id,onClick:async()=>{const r=localStorage.getItem("token");if(r){te(s.id);try{const t=await fetch(`${b}/api/password/supervisor/requests/${s.id}/reset`,{method:"POST",headers:{Authorization:`Bearer ${r}`}}),i=await t.json();if(!t.ok)throw new Error((i==null?void 0:i.error)||"Failed");se(d=>d.filter(m=>m.id!==s.id))}catch(t){alert((t==null?void 0:t.message)||"Failed to reset")}finally{te(null)}}},className:`px-3 py-1.5 rounded-md text-white text-sm ${F===s.id?"bg-gray-400":"bg-neutral-900 hover:bg-neutral-800"}`,children:F===s.id?"Resetting...":"Reset to 123"})]},s.id))})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between min-w-0",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-stone-800 to-amber-600 bg-clip-text text-transparent truncate",children:a("supervisor.title")}),e.jsx("p",{className:"text-stone-600 mt-2 truncate",children:a("supervisor.subtitle")})]}),e.jsx("div",{className:"flex items-center space-x-4 mt-4 sm:mt-0 min-w-0",children:e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-stone-500",children:[e.jsx("div",{className:"w-2 h-2 bg-emerald-500 rounded-full animate-pulse"}),e.jsx("span",{className:"truncate",children:a("supervisor.systemsOk")})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"group bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-amber-100 p-6 hover:shadow-xl transition-all duration-300 hover:-translate-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-stone-600 mb-2",children:a("supervisor.cards.amountDueTitle")}),e.jsx("p",{className:"text-3xl font-bold text-stone-900",children:D?"...":g.format(Number((u==null?void 0:u.due_total)||0))}),e.jsx("p",{className:"text-sm text-stone-500 mt-1",children:a("supervisor.cards.amountDueCaption")})]}),e.jsx("div",{className:"p-4 rounded-xl bg-gradient-to-br from-stone-700 to-stone-500 shadow-lg",children:e.jsx(x.TrendUp,{})})]}),v&&e.jsx("div",{className:"text-xs text-red-600 mt-2 truncate",children:v})]}),e.jsxs("div",{className:"group bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-amber-100 p-6 hover:shadow-xl transition-all duration-300 hover:-translate-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-stone-600 mb-2",children:a("supervisor.cards.amountPaidTitle")}),e.jsx("p",{className:"text-3xl font-bold text-stone-900",children:D?"...":g.format(Number((u==null?void 0:u.paid_total)||0))}),e.jsx("p",{className:"text-sm text-stone-500 mt-1",children:a("supervisor.cards.amountPaidCaption")})]}),e.jsx("div",{className:"p-4 rounded-xl bg-gradient-to-br from-emerald-600 to-green-500 shadow-lg",children:e.jsx(x.TrendUp,{})})]}),v&&e.jsx("div",{className:"text-xs text-red-600 mt-2 truncate",children:v})]}),e.jsxs("div",{className:"group bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-amber-100 p-6 hover:shadow-xl transition-all duration-300 hover:-translate-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-stone-600 mb-2",children:a("supervisor.cards.remainingTitle")}),e.jsx("p",{className:"text-3xl font-bold text-stone-900",children:D?"...":g.format(Number((u==null?void 0:u.remaining_total)||0))}),e.jsx("p",{className:"text-sm text-stone-500 mt-1",children:a("supervisor.cards.remainingCaption")})]}),e.jsx("div",{className:"p-4 rounded-xl bg-gradient-to-br from-amber-600 to-orange-500 shadow-lg",children:e.jsx(x.TrendUp,{})})]}),v&&e.jsx("div",{className:"text-xs text-red-600 mt-2 truncate",children:v})]}),e.jsxs("div",{className:"group bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-amber-100 p-6 hover:shadow-xl transition-all duration-300 hover:-translate-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-stone-600 mb-2",children:a("supervisor.cards.todayPaidTitle")}),e.jsx("p",{className:"text-3xl font-bold text-stone-900",children:Ce?"...":g.format(ke)}),e.jsx("p",{className:"text-sm text-stone-500 mt-1",children:a("supervisor.cards.todayPaidCaption")})]}),e.jsx("div",{className:"p-4 rounded-xl bg-gradient-to-br from-emerald-700 to-green-600 shadow-lg",children:e.jsx(x.TrendUp,{})})]}),Q&&e.jsx("div",{className:"text-xs text-red-600 mt-2 truncate",children:Q})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{onClick:()=>{var s;return(s=L.current)==null?void 0:s.scrollIntoView({behavior:"smooth"})},className:"group bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-amber-100 p-6 hover:shadow-xl transition-all duration-300 hover:-translate-y-1 cursor-pointer",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-stone-600 mb-2",children:a("supervisor.stats.totalZones")}),e.jsx("p",{className:"text-3xl font-bold text-stone-900",children:p?"...":g.format(h.length)}),e.jsx("p",{className:"text-sm text-stone-500 mt-1",children:a("supervisor.stats.assignedToYou")})]}),e.jsx("div",{className:"p-4 rounded-xl bg-gradient-to-br from-amber-600 to-orange-500 shadow-lg",children:e.jsx(x.Zone,{})})]})}),e.jsx("div",{className:"group bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-amber-100 p-6 hover:shadow-xl transition-all duration-300 hover:-translate-y-1",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-stone-600 mb-2",children:a("supervisor.stats.activeChiefs")}),e.jsx("p",{className:"text-3xl font-bold text-stone-900",children:p?"...":g.format(Ae)}),e.jsx("div",{className:"flex items-center mt-1",children:e.jsxs("div",{className:"inline-flex items-center px-2 py-1 rounded-full bg-emerald-100 text-emerald-700 text-xs font-medium",children:[e.jsx(x.TrendUp,{}),e.jsx("span",{className:"ml-1",children:a("supervisor.stats.active")})]})})]}),e.jsx("div",{className:"p-4 rounded-xl bg-gradient-to-br from-emerald-600 to-green-500 shadow-lg",children:e.jsx(x.Chief,{})})]})}),e.jsx("div",{className:"group bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-amber-100 p-6 hover:shadow-xl transition-all duration-300 hover:-translate-y-1",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-stone-600 mb-2",children:a("supervisor.stats.totalClients")}),e.jsx("p",{className:"text-3xl font-bold text-stone-900",children:p?"...":g.format(ae)}),e.jsx("p",{className:"text-sm text-stone-500 mt-1",children:a("supervisor.stats.acrossZones")})]}),e.jsx("div",{className:"p-4 rounded-xl bg-gradient-to-br from-lime-600 to-green-500 shadow-lg",children:e.jsx(x.Clients,{})})]})}),e.jsx("div",{className:"group bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-amber-100 p-6 hover:shadow-xl transition-all duration-300 hover:-translate-y-1",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-stone-600 mb-2",children:a("supervisor.stats.avgPerZone")}),e.jsx("p",{className:"text-3xl font-bold text-stone-900",children:p?"...":g.format($e)}),e.jsx("p",{className:"text-sm text-stone-500 mt-1",children:a("supervisor.stats.clientsPerZone")})]}),e.jsx("div",{className:"p-4 rounded-xl bg-gradient-to-br from-amber-500 to-yellow-500 shadow-lg",children:e.jsx(x.Clients,{})})]})})]}),e.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-amber-100 p-6 overflow-x-auto",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-6 min-w-0",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("h2",{className:"text-lg font-semibold text-stone-800",children:a("supervisor.trends.title")}),e.jsx("p",{className:"text-xs text-stone-500 mt-1",children:a("supervisor.trends.subtitle")})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-3 md:mt-0 items-end",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[11px] text-stone-600",children:a("reports.filters.year")}),e.jsx("select",{className:"px-2 py-1.5 rounded-md text-xs bg-stone-100 text-stone-700",value:M,onChange:s=>ue(Number(s.target.value)),children:Array.from({length:6}).map((s,r)=>{const t=new Date().getFullYear()-r;return e.jsx("option",{value:t,children:t},t)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[11px] text-stone-600",children:a("reports.filters.month")}),e.jsxs("select",{className:"px-2 py-1.5 rounded-md text-xs bg-stone-100 text-stone-700",value:w,onChange:s=>ge(Number(s.target.value)),children:[e.jsx("option",{value:0,children:a("reports.filters.all")}),Array.from({length:12}).map((s,r)=>{const t=r+1,d=new Date(2e3,r,1).toLocaleString(void 0,{month:"long"});return e.jsx("option",{value:t,children:d},t)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[11px] text-stone-600",children:a("reports.filters.zone")}),e.jsxs("select",{className:"px-2 py-1.5 rounded-md text-xs bg-stone-100 text-stone-700",value:N,onChange:s=>fe(s.target.value),children:[e.jsx("option",{value:"",children:a("supervisor.filters.allZones")}),h.map(s=>e.jsx("option",{value:s.id,children:s.zone_name},s.id))]})]})]})]}),e.jsx("div",{className:"h-64 relative min-w-[480px] md:min-w-0",children:ce?e.jsx("div",{className:"h-full flex items-center justify-center text-stone-500 text-sm",children:e.jsx(Ye,{})}):Y?e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-stone-600 text-sm gap-2",children:[e.jsx("div",{children:Y}),e.jsx("button",{onClick:()=>xe(s=>s+1),className:"px-3 py-1.5 rounded-md bg-amber-600 text-white",children:a("supervisor.retry")})]}):e.jsx(Ve,{data:ie.map(s=>({name:"year"in s?s.year:"month"in s?s.month:"week"in s?s.week:s.day,amount:Number(s.amount)||0})),xKey:"name",series:[{key:"amount",name:a("supervisor.trends.amount")}],height:260})})]}),e.jsxs("div",{ref:L,className:"bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-amber-100 p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-6 min-w-0",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("h2",{className:"text-xl font-bold text-stone-800",children:a("supervisor.yourZones.title")}),e.jsx("p",{className:"text-stone-600 mt-1 truncate",children:a("supervisor.yourZones.subtitle")})]}),e.jsxs("div",{className:"flex items-center space-x-3 mt-4 md:mt-0",children:[e.jsxs("label",{className:"inline-flex items-center gap-2 text-sm text-stone-600",children:[e.jsx("input",{type:"checkbox",className:"rounded",checked:_,onChange:s=>be(s.target.checked)}),a("supervisor.filters.onlyWithChief")]}),e.jsx("span",{className:"text-sm text-stone-500",children:a("supervisor.yourZones.assignedCount",{count:h.length})}),e.jsx("button",{onClick:()=>{var s;return(s=L.current)==null?void 0:s.scrollIntoView({behavior:"smooth"})},className:"px-3 py-1.5 rounded-md bg-stone-100 text-stone-700 hover:bg-stone-200 text-sm",children:a("supervisor.quick.viewZones")})]})]}),P&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 mb-6",children:e.jsxs("div",{className:"flex items-center space-x-2 text-red-700",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"font-medium",children:P})]})}),p?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((s,r)=>e.jsxs("div",{className:"bg-stone-100 rounded-xl p-6 animate-pulse",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 bg-stone-300 rounded w-20"}),e.jsx("div",{className:"h-6 bg-stone-300 rounded w-32"})]}),e.jsx("div",{className:"w-12 h-12 bg-stone-300 rounded-xl"})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"h-4 bg-stone-300 rounded w-16"}),e.jsx("div",{className:"h-4 bg-stone-300 rounded w-20"})]})}),e.jsx("div",{className:"h-10 bg-stone-300 rounded-lg mt-4"})]},r))}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[h.filter(s=>!_||!!s.chief_username).map(s=>e.jsxs("div",{className:"group bg-white rounded-xl border border-amber-100 p-6 hover:shadow-lg transition-all duration-300 hover:-translate-y-1 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 min-w-0",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("span",{className:"text-xs font-medium text-stone-500 uppercase tracking-wide",children:a("supervisor.zone")}),e.jsx("h3",{className:"text-xl font-bold text-stone-800 break-words truncate",children:s.zone_name})]}),e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-amber-600 to-amber-700 rounded-xl flex items-center justify-center shadow-lg",children:e.jsx(x.Zone,{})})]}),e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-stone-600",children:[e.jsx(x.Chief,{}),e.jsx("span",{className:"font-medium",children:a("supervisor.zoneChief")})]}),e.jsx("span",{className:`font-semibold ${s.chief_username?"text-stone-800":"text-amber-600"} truncate`,children:s.chief_username||a("supervisor.unassigned")})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-stone-600",children:[e.jsx(x.Clients,{}),e.jsx("span",{className:"font-medium",children:a("supervisor.activeClients")})]}),e.jsx("span",{className:"text-lg font-bold text-stone-800",children:g.format(s.client_count)})]})]}),e.jsxs(Be,{to:`/supervisor/zones/${s.id}/supervision`,className:"flex items-center justify-center space-x-2 w-full py-3 bg-stone-50 hover:bg-amber-50 text-stone-700 hover:text-amber-700 rounded-xl font-semibold transition-all duration-200 border border-stone-200 hover:border-amber-200 group-hover:shadow-md",children:[e.jsx("span",{children:a("supervisor.manageZone")}),e.jsx(x.Arrow,{})]})]},s.id)),!h.filter(s=>!_||!!s.chief_username).length&&!p&&e.jsxs("div",{className:"col-span-full text-center py-12",children:[e.jsx("div",{className:"w-20 h-20 bg-stone-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:e.jsx(x.Zone,{})}),e.jsx("h3",{className:"text-xl font-semibold text-stone-700 mb-2",children:a("supervisor.noZones.title")}),e.jsx("p",{className:"text-stone-500 max-w-md mx-auto",children:a("supervisor.noZones.desc")})]})]})]}),e.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-amber-100 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-stone-800",children:a("supervisor.vehicles.assignedTitle")}),e.jsx("span",{className:"text-sm text-stone-500",children:a("supervisor.vehicles.total",{count:A.length})})]}),O&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-3 text-red-700 text-sm mb-4",children:O}),ve?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[...Array(6)].map((s,r)=>e.jsxs("div",{className:"border border-amber-100 rounded-xl p-4 animate-pulse",children:[e.jsx("div",{className:"h-5 bg-stone-200 rounded w-32 mb-3"}),e.jsx("div",{className:"h-4 bg-stone-200 rounded w-40 mb-3"}),e.jsx("div",{className:"h-32 bg-stone-100 rounded"})]},r))}):e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[A.map(s=>e.jsxs("button",{type:"button",onClick:()=>{s.image_url&&(Ne(s.image_url),$(!0))},className:"text-left border border-amber-100 rounded-xl p-4 hover:shadow-md transition-shadow bg-white",title:s.image_url?a("supervisor.vehicles.viewImage"):a("supervisor.vehicles.noImage"),children:[e.jsx("div",{className:"font-semibold text-stone-800",children:s.plate}),e.jsx("div",{className:"text-sm text-stone-500",children:s.driver_username||a("supervisor.vehicles.unassignedDriver")}),e.jsx("div",{className:"mt-2 h-36 rounded overflow-hidden bg-stone-50 flex items-center justify-center",children:s.image_url?e.jsx("img",{src:s.image_url,alt:s.plate,className:"w-full h-full object-cover"}):e.jsx("span",{className:"text-stone-400 text-sm",children:a("supervisor.vehicles.noImage")})})]},s.id)),!A.length&&e.jsx("div",{className:"col-span-full text-center py-8 text-stone-500",children:a("supervisor.vehicles.noneAssigned")})]})]}),je&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black/70 flex items-center justify-center p-4",role:"dialog","aria-modal":"true",onClick:()=>$(!1),children:e.jsxs("div",{className:"relative max-w-4xl w-full",onClick:s=>s.stopPropagation(),children:[e.jsx("img",{src:we,alt:"Vehicle",className:"w-full h-auto rounded-lg shadow-lg"}),e.jsx("button",{type:"button",onClick:()=>$(!1),className:"absolute top-2 right-2 inline-flex items-center justify-center rounded-full bg-black/60 text-white w-9 h-9 hover:bg-black/80 focus:outline-none focus:ring-2 focus:ring-amber-500","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})})]})};export{Oe as default};
