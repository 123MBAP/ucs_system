import{u as Z,j as e}from"./index-DnGg16Vn.js";import{r as s,u as $}from"./react-BeLGUnOF.js";const q="http://localhost:4000",P=()=>{const{t:r}=Z(),[m,N]=s.useState(""),[g,v]=s.useState(""),[b,y]=s.useState(""),[h,E]=s.useState(""),[x,w]=s.useState(""),[z,A]=s.useState([]),[p,f]=s.useState(""),S=$(),[j,c]=s.useState(!1),[C,k]=s.useState(null),[B,u]=s.useState(null);s.useEffect(()=>{const t=localStorage.getItem("token");t&&fetch(`${q}/api/zones`,{headers:{Authorization:`Bearer ${t}`}}).then(async n=>{const i=await n.json();if(!n.ok)throw new Error((i==null?void 0:i.error)||"Failed to load zones");const d=(i.zones||[]).map(a=>({id:String(a.id),name:a.zone_name}));A(d);const o=new URLSearchParams(S.search).get("zoneId");o&&d.some(a=>a.id===String(o))&&f(String(o))}).catch(n=>console.error("Load zones error:",n))},[S.search]);function I(t){if(t.preventDefault(),u(null),k(null),c(!0),!m.trim()||!g.trim()||!b.trim()||!h.trim()||!p||!x.trim()){u("All fields are required."),c(!1);return}const n=Number(x);if(Number.isNaN(n)||n<=0){u("Monthly amount must be a positive number."),c(!1);return}const i={firstName:m,lastName:g,username:b,phone:h,zoneId:p,monthlyAmount:n},d=localStorage.getItem("token");if(!d){u("You must be logged in as manager or supervisor to register a client."),c(!1);return}fetch(`${q}/api/clients`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`},body:JSON.stringify(i)}).then(async l=>{var a;const o=await l.json();if(!l.ok)throw new Error((o==null?void 0:o.error)||"Failed to register client");k(`Client registered with id ${((a=o==null?void 0:o.client)==null?void 0:a.id)||""}`.trim()),N(""),v(""),y(""),E(""),w(""),f("")}).catch(l=>u((l==null?void 0:l.message)||"Failed to register client")).finally(()=>c(!1))}return e.jsxs("div",{className:"max-w-2xl space-y-6 p-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-amber-500 to-amber-600 bg-clip-text text-transparent",children:r("register.client.title")}),e.jsx("p",{className:"text-neutral-600 mt-1",children:r("register.client.subtitle")})]}),e.jsx("div",{className:"rounded-2xl shadow-sm border p-6 bg-white",style:{borderColor:"#E5E7EB"},children:e.jsxs("form",{onSubmit:I,className:"space-y-5",children:[B&&e.jsx("div",{className:"rounded-lg border border-red-200 bg-red-50 p-3 text-red-700",children:B}),C&&e.jsx("div",{className:"rounded-lg border border-emerald-200 bg-emerald-50 p-3 text-emerald-700",children:C}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-800 mb-1",children:r("register.common.firstName")}),e.jsx("input",{className:"w-full px-3 py-2 bg-white border rounded-lg focus:outline-none focus:ring-2",style:{borderColor:"#E5E7EB"},value:m,onChange:t=>N(t.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-800 mb-1",children:r("register.common.lastName")}),e.jsx("input",{className:"w-full px-3 py-2 bg-white border rounded-lg focus:outline-none focus:ring-2",style:{borderColor:"#E5E7EB"},value:g,onChange:t=>v(t.target.value),required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-800 mb-1",children:r("register.common.usernameOrEmail")}),e.jsx("input",{className:"w-full px-3 py-2 bg-white border rounded-lg focus:outline-none focus:ring-2",style:{borderColor:"#E5E7EB"},value:b,onChange:t=>y(t.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-800 mb-1",children:r("register.common.phoneNumber")}),e.jsx("input",{className:"w-full px-3 py-2 bg-white border rounded-lg focus:outline-none focus:ring-2",style:{borderColor:"#E5E7EB"},value:h,onChange:t=>E(t.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-800 mb-1",children:r("register.common.assignZone")}),e.jsxs("select",{value:p,onChange:t=>f(t.target.value),className:"w-full px-3 py-2 bg-white border rounded-lg focus:outline-none focus:ring-2",style:{borderColor:"#E5E7EB"},required:!0,children:[e.jsx("option",{value:"",children:r("register.common.selectZone")}),z.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-800 mb-1",children:r("register.client.amountPerMonth")}),e.jsx("input",{type:"number",min:"0",step:"0.01",className:"w-full px-3 py-2 bg-white border rounded-lg focus:outline-none focus:ring-2",style:{borderColor:"#E5E7EB"},value:x,onChange:t=>w(t.target.value),required:!0})]}),e.jsx("div",{className:"pt-2",children:e.jsx("button",{type:"submit",disabled:j,className:`inline-flex items-center justify-center px-5 py-2.5 rounded-lg font-semibold text-white shadow-sm transition-colors ${j?"bg-amber-400 cursor-not-allowed":"bg-amber-600 hover:bg-amber-700"}`,children:j?"â€¦":r("register.client.button")})})]})})]})};export{P as default};
