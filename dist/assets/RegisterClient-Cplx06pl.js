import{j as e}from"./index-Cb5Y6uas.js";import{r as n,u as P}from"./react-CzDbI3ao.js";const q="http://localhost:4000",F=()=>{const[u,j]=n.useState(""),[m,N]=n.useState(""),[g,v]=n.useState(""),[b,w]=n.useState(""),[x,y]=n.useState(""),[A,E]=n.useState([]),[h,f]=n.useState(""),z=P(),[p,l]=n.useState(!1),[S,k]=n.useState(null),[C,c]=n.useState(null);n.useEffect(()=>{const t=localStorage.getItem("token");t&&fetch(`${q}/api/zones`,{headers:{Authorization:`Bearer ${t}`}}).then(async r=>{const a=await r.json();if(!r.ok)throw new Error((a==null?void 0:a.error)||"Failed to load zones");const d=(a.zones||[]).map(i=>({id:String(i.id),name:i.zone_name}));E(d);const s=new URLSearchParams(z.search).get("zoneId");s&&d.some(i=>i.id===String(s))&&f(String(s))}).catch(r=>console.error("Load zones error:",r))},[z.search]);function L(t){if(t.preventDefault(),c(null),k(null),l(!0),!u.trim()||!m.trim()||!g.trim()||!b.trim()||!h||!x.trim()){c("All fields are required."),l(!1);return}const r=Number(x);if(Number.isNaN(r)||r<=0){c("Monthly amount must be a positive number."),l(!1);return}const a={firstName:u,lastName:m,username:g,phone:b,zoneId:h,monthlyAmount:r},d=localStorage.getItem("token");if(!d){c("You must be logged in as manager or supervisor to register a client."),l(!1);return}fetch(`${q}/api/clients`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`},body:JSON.stringify(a)}).then(async o=>{var i;const s=await o.json();if(!o.ok)throw new Error((s==null?void 0:s.error)||"Failed to register client");k(`Client registered with id ${((i=s==null?void 0:s.client)==null?void 0:i.id)||""}`.trim()),j(""),N(""),v(""),w(""),y(""),f("")}).catch(o=>c((o==null?void 0:o.message)||"Failed to register client")).finally(()=>l(!1))}return e.jsxs("div",{className:"max-w-2xl space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-zinc-800 to-indigo-600 bg-clip-text text-transparent",children:"Register Client"}),e.jsx("p",{className:"text-zinc-600 mt-1",children:"Create a new client and assign them to a zone"})]}),e.jsx("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-white/20 p-6",children:e.jsxs("form",{onSubmit:L,className:"space-y-5",children:[C&&e.jsx("div",{className:"rounded-xl border border-red-200 bg-red-50 p-3 text-red-700",children:C}),S&&e.jsx("div",{className:"rounded-xl border border-emerald-200 bg-emerald-50 p-3 text-emerald-700",children:S}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-zinc-700 mb-1",children:"First Name"}),e.jsx("input",{className:"w-full px-3 py-2 bg-white border border-zinc-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all",value:u,onChange:t=>j(t.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-zinc-700 mb-1",children:"Last Name"}),e.jsx("input",{className:"w-full px-3 py-2 bg-white border border-zinc-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all",value:m,onChange:t=>N(t.target.value),required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-zinc-700 mb-1",children:"Username or Email"}),e.jsx("input",{className:"w-full px-3 py-2 bg-white border border-zinc-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all",value:g,onChange:t=>v(t.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-zinc-700 mb-1",children:"Phone Number"}),e.jsx("input",{className:"w-full px-3 py-2 bg-white border border-zinc-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all",value:b,onChange:t=>w(t.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-zinc-700 mb-1",children:"Assign Zone"}),e.jsxs("select",{value:h,onChange:t=>f(t.target.value),className:"w-full px-3 py-2 bg-white border border-zinc-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all",required:!0,children:[e.jsx("option",{value:"",children:"-- Select zone --"}),A.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-zinc-700 mb-1",children:"Amount to Pay Per Month"}),e.jsx("input",{type:"number",min:"0",step:"0.01",className:"w-full px-3 py-2 bg-white border border-zinc-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all",value:x,onChange:t=>y(t.target.value),required:!0})]}),e.jsx("div",{className:"pt-2",children:e.jsx("button",{type:"submit",disabled:p,className:`inline-flex items-center justify-center px-5 py-2.5 rounded-xl font-semibold text-white shadow-sm transition-all ${p?"bg-indigo-400 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700"}`,children:p?"Registeringâ€¦":"Register Client"})})]})})]})};export{F as default};
