import{j as e}from"./index-DaGMaRVu.js";import{g as N,f as b,r as d}from"./react-CzDbI3ao.js";const p="http://localhost:4000",y=()=>{const{id:t}=N(),r=b(),[s,h]=d.useState(null),[a,u]=d.useState({amountToBePaid:null,currentMonthPaid:null,todayPaid:null}),[g,o]=d.useState(!1),[c,m]=d.useState(null),[x,j]=d.useState(!1);return d.useEffect(()=>{const l=localStorage.getItem("token");!l||!t||(o(!0),m(null),fetch(`${p}/api/zones/${t}`,{headers:{Authorization:`Bearer ${l}`}}).then(async n=>{const i=await n.json();if(!n.ok)throw new Error((i==null?void 0:i.error)||"Failed to load zone");h(i.zone),u(i.payments||{amountToBePaid:null,currentMonthPaid:null,todayPaid:null})}).catch(n=>m((n==null?void 0:n.message)||"Failed to load zone")).finally(()=>o(!1)))},[t]),g?e.jsx("div",{className:"p-6",children:"Loading…"}):c?e.jsx("div",{className:"p-6 text-red-600",children:c}):s?e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("div",{children:e.jsx("button",{onClick:()=>r(-1),className:"text-blue-600 underline text-sm",children:"← Back"})}),e.jsxs("div",{className:"bg-white rounded shadow p-4 border",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold",children:s.zone_name}),e.jsxs("span",{className:"text-sm text-gray-500",children:["Zone #",s.id]})]}),e.jsxs("div",{className:"text-sm text-gray-600 mt-2",children:[s.cell,", ",s.village]}),e.jsx("div",{className:"text-sm text-gray-700 mt-2",children:s.description})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white rounded shadow p-4 border",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Chief of the Zone"}),e.jsx("div",{className:"text-xl font-semibold",children:s.chief_username??"Unassigned"})]}),e.jsxs("div",{className:"bg-white rounded shadow p-4 border",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Clients"}),e.jsx("div",{className:"text-xl font-semibold",children:s.client_count})]}),e.jsxs("div",{className:"bg-white rounded shadow p-4 border",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Amount To Be Paid"}),e.jsx("div",{className:"text-xl font-semibold",children:a.amountToBePaid!=null?`$${a.amountToBePaid}`:"N/A"})]}),e.jsxs("div",{className:"bg-white rounded shadow p-4 border",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Current Month Paid"}),e.jsx("div",{className:"text-xl font-semibold",children:a.currentMonthPaid!=null?`$${a.currentMonthPaid}`:"N/A"})]})]}),e.jsxs("div",{className:"bg-white rounded shadow p-4 border",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Today's Payments"}),e.jsx("div",{className:"text-xl font-semibold",children:a.todayPaid!=null?`$${a.todayPaid}`:"N/A"})]}),e.jsxs("div",{className:"bg-white rounded shadow p-4 border",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Zone Management"}),e.jsx("button",{onClick:()=>j(l=>!l),className:"text-blue-600 underline text-sm",children:x?"Hide":"Manage this zone"})]}),x&&e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsx("button",{className:"px-4 py-2 border rounded hover:bg-gray-50 text-sm",onClick:()=>r(`/register-supervisor?zoneId=${t}&reassign=1`),children:"Reassign Supervisor"}),e.jsx("button",{className:"px-4 py-2 border rounded hover:bg-gray-50 text-sm",onClick:()=>r(`/register-chief?zoneId=${t}&reassign=1`),children:"Reassign Chief of Zone"}),e.jsx("button",{className:"px-4 py-2 border rounded hover:bg-gray-50 text-sm",onClick:()=>r(`/register-client?zoneId=${t}`),children:"Add Client"})]})]})]}):e.jsx("div",{className:"p-6",children:"Zone not found."})};export{y as default};
