import{j as e}from"./index-B9Qtw13a.js";import{r as s}from"./react-BeLGUnOF.js";const U="http://localhost:4000",K=()=>{const[h,F]=s.useState(""),[g,B]=s.useState(""),[m,I]=s.useState(""),[b,z]=s.useState(""),[n,p]=s.useState(""),[M,o]=s.useState(null),[R,j]=s.useState(null),[v,D]=s.useState(!1),[w,N]=s.useState(!1),[y,k]=s.useState(!1),[C,E]=s.useState(!1),[S,L]=s.useState(!1),[_,i]=s.useState(!1),$=s.useRef(null),[c,u]=s.useState(null),[P,x]=s.useState(!1);s.useEffect(()=>{const t=localStorage.getItem("token");t&&fetch(`${U}/api/profile`,{headers:{Authorization:`Bearer ${t}`}}).then(async r=>{const a=await r.json();if(!r.ok)throw new Error((a==null?void 0:a.error)||"Failed to load profile");const l=a.profile||{};I(l.username||""),F(l.first_name||""),B(l.last_name||""),z(l.phone_number||""),p(l.profile_image_url||"")}).catch(r=>o(r.message||"Failed to load profile"))},[]);function A(t){p(t.target.value)}function T(){var t;(t=$.current)==null||t.click()}function W(t){var l;const r=(l=t.target.files)==null?void 0:l[0];if(!r)return;const a=new FileReader;a.onload=()=>{const d=String(a.result||"");u(d),i(!0)},a.readAsDataURL(r)}async function J(t){if(t.preventDefault(),o(null),j(null),!m.trim()){o("Username is required.");return}const r=localStorage.getItem("token");if(!r){o("Not authenticated");return}D(!0);try{let a=n;if(c){const O=await fetch(`${U}/api/profile/upload-base64`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({dataUrl:c})}),f=await O.json();if(!O.ok)throw new Error((f==null?void 0:f.error)||"Failed to upload image");a=f.profile_image_url||a,p(a)}const l=await fetch(`${U}/api/profile`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({firstName:h,lastName:g,username:m,phone:b,profileImageUrl:a})}),d=await l.json();if(!l.ok)throw new Error((d==null?void 0:d.error)||"Failed to save profile");j("Profile saved successfully!"),N(!1),k(!1),E(!1),L(!1),i(!1),u(null)}catch(a){o((a==null?void 0:a.message)||"Failed to save profile")}finally{D(!1)}}const V=w||y||C||S||_;return s.useEffect(()=>{function t(r){r.key==="Escape"&&x(!1)}if(P)return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[P]),e.jsxs("div",{className:"min-h-screen bg-gray-50 p-4 sm:p-6 lg:p-8",children:[e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-charcoal",children:"Profile Settings"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Manage your personal information and account details"})]}),e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden",children:e.jsxs("form",{onSubmit:J,className:"p-6 sm:p-8",children:[M&&e.jsxs("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-xl text-red-700 flex items-center space-x-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{children:M})]}),R&&e.jsxs("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-xl text-green-700 flex items-center space-x-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),e.jsx("span",{children:R})]}),e.jsx("div",{className:"flex flex-col lg:flex-row gap-8",children:e.jsx("div",{className:"lg:w-1/3",children:e.jsxs("div",{className:"bg-gray-50 rounded-xl p-6 border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-charcoal mb-4",children:"Profile Photo"}),e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx("div",{className:"w-32 h-32 rounded-full bg-gray-200 overflow-hidden flex items-center justify-center border-4 border-white shadow-lg",children:c||n?e.jsx("button",{type:"button",onClick:()=>x(!0),className:"block w-full h-full focus:outline-none focus:ring-2 focus:ring-amber-500 cursor-zoom-in","aria-label":"View profile image",title:"Click to view",children:e.jsx("img",{src:c||n,alt:"Profile",className:"w-full h-full object-cover"})}):e.jsxs("div",{className:"text-gray-400 flex flex-col items-center",children:[e.jsx("svg",{className:"w-12 h-12",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),e.jsx("span",{className:"text-xs mt-1",children:"No image"})]})}),e.jsx("div",{className:"flex flex-col space-y-3 w-full",children:_?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",onClick:T,className:"px-4 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 transition-colors font-medium text-sm",children:"Choose File"}),e.jsx("input",{ref:$,type:"file",accept:"image/*",onChange:W,className:"hidden"}),e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{className:"block text-sm font-medium text-charcoal mb-2",children:"Or enter image URL"}),e.jsx("input",{type:"url",value:n,onChange:A,placeholder:"https://example.com/image.jpg",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent text-sm"})]}),e.jsx("button",{type:"button",onClick:()=>{i(!1),u(null)},className:"px-4 py-2 bg-gray-100 text-charcoal rounded-lg hover:bg-gray-200 transition-colors font-medium text-sm mt-2",children:"Cancel"})]}):e.jsx("button",{type:"button",onClick:()=>i(!0),className:"px-4 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 transition-colors font-medium text-sm",children:"Change Photo"})})]})]})})}),e.jsx("div",{className:"lg:w-2/3",children:e.jsxs("div",{className:"bg-gray-50 rounded-xl p-6 border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-charcoal mb-6",children:"Personal Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"block text-sm font-medium text-charcoal",children:"First Name"}),e.jsx("button",{type:"button",onClick:()=>N(t=>!t),className:"text-xs text-amber-600 hover:text-amber-700 font-medium",children:w?"Cancel":"Edit"})]}),w?e.jsx("input",{className:"w-full px-3 py-2 rounded-lg border border-gray-300 bg-white focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent",value:h,onChange:t=>F(t.target.value),placeholder:"Enter first name"}):e.jsx("div",{className:"w-full px-3 py-2 rounded-lg text-charcoal",children:h||"-"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"block text-sm font-medium text-charcoal",children:"Last Name"}),e.jsx("button",{type:"button",onClick:()=>k(t=>!t),className:"text-xs text-amber-600 hover:text-amber-700 font-medium",children:y?"Cancel":"Edit"})]}),y?e.jsx("input",{className:"w-full px-3 py-2 rounded-lg border border-gray-300 bg-white focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent",value:g,onChange:t=>B(t.target.value),placeholder:"Enter last name"}):e.jsx("div",{className:"w-full px-3 py-2 rounded-lg text-charcoal",children:g||"-"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"block text-sm font-medium text-charcoal",children:"Username"}),e.jsx("button",{type:"button",onClick:()=>E(t=>!t),className:"text-xs text-amber-600 hover:text-amber-700 font-medium",children:C?"Cancel":"Edit"})]}),C?e.jsx("input",{className:"w-full px-3 py-2 rounded-lg border border-gray-300 bg-white focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent",value:m,onChange:t=>I(t.target.value),placeholder:"Enter username"}):e.jsx("div",{className:"w-full px-3 py-2 rounded-lg text-charcoal",children:m||"-"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"block text-sm font-medium text-charcoal",children:"Phone Number"}),e.jsx("button",{type:"button",onClick:()=>L(t=>!t),className:"text-xs text-amber-600 hover:text-amber-700 font-medium",children:S?"Cancel":"Edit"})]}),S?e.jsx("input",{className:"w-full px-3 py-2 rounded-lg border border-gray-300 bg-white focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent",value:b,onChange:t=>z(t.target.value),placeholder:"Enter phone number"}):e.jsx("div",{className:"w-full px-3 py-2 rounded-lg text-charcoal",children:b||"-"})]})]})]})}),V&&e.jsxs("div",{className:"mt-8 flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>{N(!1),k(!1),E(!1),L(!1),i(!1),u(null),j(null),o(null)},className:"px-6 py-2 bg-gray-100 text-charcoal rounded-lg hover:bg-gray-200 transition-colors font-medium",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:v,className:`px-6 py-2 rounded-lg font-medium transition-colors ${v?"bg-amber-400 cursor-not-allowed text-white":"bg-amber-600 hover:bg-amber-700 text-white"}`,children:v?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("svg",{className:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 2v4m0 12v4m8-10h-4M6 12H2"})}),e.jsx("span",{children:"Saving..."})]}):"Save Changes"})]})]})})]}),P&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black/70 flex items-center justify-center p-4",onClick:()=>x(!1),"aria-modal":"true",role:"dialog",children:e.jsxs("div",{className:"relative max-w-3xl w-full",onClick:t=>t.stopPropagation(),children:[e.jsx("img",{src:c||n,alt:"Profile full",className:"w-full h-auto rounded-lg shadow-lg"}),e.jsx("button",{type:"button",onClick:()=>x(!1),className:"absolute top-2 right-2 inline-flex items-center justify-center rounded-full bg-black/60 text-white w-9 h-9 hover:bg-black/80 focus:outline-none focus:ring-2 focus:ring-amber-500","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})}),e.jsx("style",{children:`
        .text-charcoal {
          color: #1E1E1E;
        }
        .bg-amber-600 {
          background-color: #D97706;
        }
        .bg-amber-700 {
          background-color: #B45309;
        }
        .text-amber-600 {
          color: #D97706;
        }
        .text-amber-700 {
          color: #B45309;
        }
        .focus\\:ring-amber-500:focus {
          --tw-ring-color: #D97706;
        }
      `})]})};export{K as default};
